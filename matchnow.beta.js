!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MatchNow=t():e.MatchNow=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Auth:()=>D,CookieManager:()=>H,EventBanner:()=>n});const n=(e=>{const t="eventBannerSlider",n={arrows:!1,focusOnSelect:!0,variableWidth:!0,infinite:!0,speed:1e4,autoplay:!0,autoplaySpeed:0,slidesToScroll:1,slidesToShow:1,cssEase:"linear"};let r;return{start:function(e){r=$(e),this.render()},render:function(){if(!r)return;const e='<div class="event__banner"><div id="'+t+'" class="slick slick-slider"><div class="slick-slide"><div class="event__banner__text"><i></i>The first month, <em>50% discount for the first month</em></div></div><div class="slick-slide"><div class="event__banner__text"><i></i>The first month, <em>50% discount for the first month</em></div></div></div></div>';r.html(e),this.run()},run:function(){r.find("#"+t).slick(n)}}})(),r=class{static setItem(e,t){try{return localStorage.setItem(e,t),!0}catch(e){return!1}}static getItem(e){try{const t=localStorage.getItem(e);return null==t||void 0===t||""===t?null:t}catch(e){return null}}static removeItem(e){try{return localStorage.removeItem(e),!0}catch(e){return!1}}},i=()=>{const e=window.location.search;return 0===e.indexOf("?")?e.slice(1,e.length):null},s=e=>{if(null==e)return null;const t={};return e.split("&").map((e=>{let[n,r]=e.split("=");t[n]=r})),t},o=e=>{let t="";return Object.entries(e).map((([e,n])=>{a(n)&&(t+=""===t?"?":"&",t+=`${e}=${encodeURIComponent(n)}`)})),t},c=e=>null==e||(void 0===e||("string"==typeof e&&""===e.trim()||(!!(Array.isArray(e)&&e.length<1)||"object"==typeof e&&Object.keys(e).length<1))),a=e=>!c(e),l="page",h="web",u="OSC001",d="live",f="Invalid Type",T="Requried clientId",p="Requried redirectUri",m="Not found access token",y="Not found refresh token",I="Request failed verify token",_="Request failed refresh token",v="Request failed get user profile",E="Request failed sign out",g="token",O="type",w="accessToken",k="wematchnow_auth",S={LOCAL:"https://dev-member.wematchnow.com",DEV:"https://dev-member.wematchnow.com",LIVE:"https://member.wematchnow.com"},N="/earlybird/login",A="/login",C="/modify",R={LOCAL:"",DEV:"https://dev-api.wematchnow.com",LIVE:"https://api.wematchnow.com"},b="/ext/auth/v1/oauth/token/verify",U="/ext/auth/v1/oauth/token/refresh",P="/ext/member/v1/user",x="/ext/auth/v1/signout/account",j={GET:"GET",POST:"POST"},q={CONTENT_TYPE:"Content-Type",X_CLIENT_ID:"X-Client-Id",X_CLIENT_SECRET:"X-Client-Secret",AUTHORIZATION:"Authorization",X_OS_CODE:"X-Os-Code",X_OWNER_CONTENT:"X-Owner-Content"},X={CONTENT_TYPE_JSON:"application/json",AUTHORIZATION_TYPE:"bearer"},L={GRANT_TYPE:{REFRESH_TOKEN:"refresh_token"}},D=class{#e;#t;#n;constructor({clientId:e,clientSecret:t,redirectUri:n,displayType:r=l,osType:i=h,environment:s=d,autoRefreshToken:o=!1}){c(e)&&new Error(T),c(n)&&new Error(p),this.#e=e,this.#t=t,this.redirectUri=n,this.displayType=r,this.osType=i,this.environment=s.toUpperCase(),this.autoRefreshToken=o}init(){this.#n=this.#r()}#r(){const e=i();let t=null;if(a(e)&&e.includes(w))t=s(e);else try{t=JSON.parse(r.getItem(k))}catch(e){t=null}return t}#i(){const e=k,t=JSON.stringify(this.#n);r.setItem(e,t)}#s(){this.#n=null,r.removeItem(k)}openSignIn(){const e=i();let t,n,r;if(a(e)&&e.includes(g))try{t=s(e)[g]}catch(e){}t?(n=N,r=o({clientId:this.#e,redirectUri:this.redirectUri,displayType:this.displayType,osType:this.osType,token:t})):(n=A,r=o({clientId:this.#e,redirectUri:this.redirectUri,displayType:this.displayType,osType:this.osType}));const c=S[this.environment]+n+r;this.displayType===l?window.location.href=c:window.open(c,"MEMBERSHIP","left=0, top=0, width=375, height=667")}openMyProfile(){const e=S[this.environment]+C+o({clientId:this.#e,redirectUri:this.redirectUri,displayType:this.displayType,osType:this.osType});window.location.href=e}async signIn(e){if("function"!=typeof e)throw new TypeError(f);let t=await this.#o();return this.autoRefreshToken&&t.code>0&&(t=await this.#c(),0===t.code&&(this.#n=t.value)),0===t.code?this.#i():this.#s(),e({code:t.code,message:t.message})}async#o(){const e=this.#n?.accessToken;if(c(e))return{code:-1,message:m};try{const t=await fetch(R[this.environment]+b,{headers:{[q.X_CLIENT_ID]:this.#e,[q.AUTHORIZATION]:`${X.AUTHORIZATION_TYPE} ${e}`}});return t.ok||200===t.status?await t.json():{code:-1,message:I}}catch(e){return{code:-1,message:I}}}async#c(){const e=this.#n?.refreshToken,t={grant_type:L.GRANT_TYPE.REFRESH_TOKEN,refresh_token:e};if(c(e))return{code:-1,message:y};try{const e=await fetch(R[this.environment]+U,{method:j.POST,body:JSON.stringify(t),headers:{[q.CONTENT_TYPE]:X.CONTENT_TYPE_JSON,[q.X_OS_CODE]:u,[q.X_CLIENT_ID]:this.#e,[q.X_CLIENT_SECRET]:this.#t}});if(!e.ok&&200!==e.status)return{code:-1,message:_};const n=await e.json();return{code:n.code,message:n.message,value:{accessToken:n.value.access_token,expiresIn:n.value.expires_in,refreshToken:n.value.refresh_token,refreshTokenExpiresIn:n.value.refresh_token_expires_in}}}catch(e){return{code:-1,message:_}}}async refreshToken(e){if("function"!=typeof e)throw new TypeError(f);return e(await this.#c())}async getUserProfile(e){if("function"!=typeof e)throw new TypeError(f);return e(await this.#a())}async#a(){const e=this.#n?.accessToken;if(c(e))return{code:-1,message:m};try{const t=await fetch(R[this.environment]+P,{headers:{[q.X_CLIENT_ID]:this.#e,[q.AUTHORIZATION]:e}});return t.ok||200===t.status?await t.json():{code:-1,message:v}}catch(e){return{code:-1,message:v}}}async signOut(e){if("function"!=typeof e)throw new TypeError(f);let t=await this.#l();return this.#s(),e(t)}async#l(){const e=this.#n?.accessToken;if(c(e))return{code:-1,message:m};try{const t=await fetch(R[this.environment]+x,{method:j.POST,headers:{[q.X_CLIENT_ID]:this.#e,[q.X_CLIENT_SECRET]:this.#t,[q.AUTHORIZATION]:`${X.AUTHORIZATION_TYPE} ${e}`}});return t.ok||200===t.status?await t.json():{code:-1,message:E}}catch(e){return{code:-1,message:E}}}getUserType(){const e=i();if(a(e)&&e.includes(O))try{return s(e)[O]}catch(e){return null}}},H={getItem:e=>{const t=document.cookie.split(";");let n=null;for(let r of t){const[t,i]=r.trim().split("=");if(e===t){n=i;break}}return n},setItem:(e,t,n,r)=>{let i=`${e}=${encodeURIComponent(t)}`;n?.constructor===Date&&(i+="; expires="+n.toUTCString()),r&&(i+="; domain="+r),document.cookie=i}};return t})()));